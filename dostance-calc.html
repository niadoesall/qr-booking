<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Distance + Price Calculator</title>
<style>
  body {font-family: sans-serif; margin: 1em;}
  label {display:block; margin-top:1em;}
  input, button {padding:0.4em; width:100%;}
  #result {margin-top:1em; font-weight:bold;}
</style>
<script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places"></script>
<script>
async function getDistance(){
  const origin = document.getElementById("origin").value.trim();
  const dest = document.getElementById("dest").value.trim();
  if(!origin || !dest){return;}

  const service = new google.maps.DistanceMatrixService();
  service.getDistanceMatrix({
      origins:[origin],
      destinations:[dest],
      travelMode:'DRIVING',
      unitSystem: google.maps.UnitSystem.IMPERIAL
  }, (res,status)=>{
      if(status!=='OK'){document.getElementById('result').innerText='Error: '+status;return;}
      const element = res.rows[0].elements[0];
      if(element.status!=='OK'){document.getElementById('result').innerText='Route not found';return;}
      const miles = element.distance.value / 1609.34; // meters → miles
      const price = 75 + Math.max(0, miles - 5) * 2;
      document.getElementById('result').innerText =
        `${miles.toFixed(1)} mi → $${price.toFixed(2)}`;

      // Push price to Jotform if embedded
      if(window.parent && window.parent.postMessage){
        window.parent.postMessage({price:price.toFixed(2)}, "*");
      }
  });
}
</script>
</head>
<body>
  <label>Origin (store address)</label>
  <input id="origin" placeholder="e.g. 201 NW Coveland St, Coupeville WA" />

  <label>Destination (delivery address)</label>
  <input id="dest" placeholder="Type delivery address" onblur="getDistance()" />

  <div id="result"></div>
</body>
</html>
